language: rust

matrix:
  allow_failures:
    - rust: nightly
  include:
    - rust: nightly
      env: FEATURES=nightly
    - rust: beta
      env: FEATURES=''
    - rust: stable
      env: FEATURES=''
    - rust: 1.1.0
      env: FEATURES=''
    - rust: 1.0.0
      env: FEATURES=''
script:
   - cargo test --features "$FEATURES"

after_success: |
    cargo doc \
    && echo '<meta http-equiv=refresh content=0;url=little/index.html>' > target/doc/index.html && \
    sudo pip install ghp-import && \
    ghp-import -n target/doc && \
    git push -qf https://${TOKEN}@github.com/${TRAVIS_REPO_SLUG}.git gh-pages
